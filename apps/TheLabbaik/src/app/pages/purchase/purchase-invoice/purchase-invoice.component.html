<form (ngSubmit)="SaveData()" #fromPurchase="ngForm">
  <div class="row no-pad">
    <div class="col-md-2">
      <label for="dp1">Date:</label>
      <div class="input-group">
        <input
          class="form-control"
          placeholder="yyyy-mm-dd"
          name="dp1"
          [(ngModel)]="purchase.Date"
          ngbDatepicker
          disabled
          #d1="ngbDatepicker"
        />

        <div class="input-group-append">
          <button type="button" class="btn btn-warning" (click)="d1.toggle()">
            <i class="fa fa-calendar"></i>
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-2">
      <ft-stores
      name="Stores"
        required
        [caption]="'select Store'"
        [(ngModel)]="purchase.StoreID"
        [addlabel]="true"
      ></ft-stores>
    </div>
    <div class="form-group col-md-2">
      <label for="customer">Acct Type </label>
      <ng-select
        #cmbActType
        name="accttype"
        id="accttype"
        class="custom"
        [items]="AcctTypes"
        [virtualScroll]="true"
        bindLabel="AcctType"
        bindValue="AcctTypeID"
        placeholder="Select AcctType"
        (change)="getAccounts($event)"
      >
      </ng-select>
    </div>
    <div class="form-group col-md-4">
      <label for="customer"
        >Account
        <span
          *ngIf="cmbCustomers.invalid && cmbCustomers.touched"
          class="text-right text-danger"
          >Account is required
        </span></label
      >
      <ng-select
        #cmbCustomers="ngModel"
        name="customer"
        id="customer"
        class="custom"
        [items]="Accounts"
        [virtualScroll]="true"
        bindLabel="CustomerName"
        bindValue="CustomerID"
        placeholder="Select Account"
        [(ngModel)]="purchase.CustomerID"
        (change)="CustomerSelected($event)"
        required
      >
      </ng-select>
    </div>
    <div class="col-md-1 form-group">
      <label for="">Adress</label>
      <p>
        <Strong> {{ SelectCust.Address }}, {{ SelectCust.City }}</Strong>
      </p>
    </div>
    <div class="col-md-1 form-group">
      <label for="">Balance</label>
      <p>
        <Strong> {{ SelectCust.Balance }} </Strong>
      </p>
    </div>
  </div>
  <form #formqty="ngForm">
    <div class="row no-gutter">
      <div class="col-md-3">
        <div class="form-group">
          <label for="supplier">Select Product:</label>
          <ng-select
            #cmbProd
            name="cmbProd"
            id="cmbProd"
            class="custom"
            [items]="Prods"
            [virtualScroll]="true"
            bindLabel="ItemName"
            bindValue="ItemID"
            placeholder="Select Item..."
            (change)="ProductSelected($event)"
            [(ngModel)]="pdetails.ItemID"
            required
          >
          </ng-select>
        </div>
      </div>
      <div class="col-md-9">
        <div class="row no-gutter">
          <div class="col-md-2">
            <div class="form-group">
              <label for="qty">Packed Qty:</label>
              <input
                type="number"
                class="form-control dation-field"
                required="required"
                id="qty"
                name="qty"
                [(ngModel)]="pdetails.Qty"
                placeholder="0"
              />
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label for="Packing">Packing:</label>
              <input
                type="number"
                class="form-control dation-field"
                required="required"
                id="Packing"
                name="Packing"
                [(ngModel)]="pdetails.Packing"
                placeholder="0"
                disabled
              />
            </div>
          </div>
          <div class="col-md-1">
            <div class="form-group">
              <label for="Pcs">Pcs:</label>
              <input
                type="number"
                class="form-control dation-field"
                required="required"
                id="Pcs"
                name="Pcs"
                [(ngModel)]="pdetails.Pcs"
                placeholder="0"
              />
            </div>
          </div>
          <div class="col-md-1">
            <div class="form-group">
              <label for="bonus">Free:</label>
              <input
                type="number"
                class="form-control"
                id="bonus"
                name="bonus"
                [(ngModel)]="pdetails.Bonus"
                placeholder="0"
              />
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label for="supplier">P. Price:</label>
              <input
                type="number"
                class="form-control"
                id="pprice"
                name="pprice"
                [(ngModel)]="pdetails.PPrice"
                placeholder="0"
              />
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label for="bonus">Amount:</label>
              <input
                type="number"
                class="form-control"
                id="pamount"
                name="pamount"
                readonly
                [value]="
                  pdetails.Qty * pdetails.PPrice * 1 +
                  ((pdetails.Pcs * pdetails.PPrice) / pdetails.Packing) * 1
                "
              />
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label>&nbsp;</label>
              <button
                type="button"
                class="btn btn-primary form-control"
                [disabled]="!formqty.form.valid"
                (click)="AddOrder()"
                accesskey="a"
              >
                Add
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
  <div style="margin: 5px; padding-bottom: 10px">
    <h5 class="mb-3">Purchase Details</h5>
    <div class="table-responsive table-bordered table-condensed pb-1">
      <ng2-smart-table
        class="table table-hover"
        [settings]="settings"
        [source]="data"
        (deleteConfirm)="onDeleteConfirm($event)"
        (editConfirm)="onEdit($event)"
      >
      </ng2-smart-table>
    </div>
    <div class="row no-gutter">
      <div class="col-md-8">
        <div class="row no-gutter">
          <div class="col-md-12">
            <div class="form-group">
              <label for="notes">Notes:</label>

              <input
                type="text"
                class="form-control"
                id="notes"
                name="notes"
                [(ngModel)]="purchase.Notes"
                placeholder="x"
              />
            </div>
          </div>
        </div>
        <div class="row no-gutter">
          <div class="col-md-6">
            <div class="form-group">
              <label for="dp2">&nbsp;</label>
              <button
                type="button"
                class="btn btn-primary form-control"
                [disabled]="!fromPurchase.form.valid || data.count() == 0"
                (click)="SaveData()"
                accesskey="s"
              >
                Save
              </button>
            </div>
          </div>

          <div class="col-md-6">
            <div class="form-group">
              <label for="dp2">&nbsp;</label>
              <button
                type="button"
                class="btn btn-danger form-control"
                (click)="Cancel()"
              >
                Cancel
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="row no-gutter">
          <div class="col-md-6">
            <label for="gtotal" style="padding-top: 5px">Total Amount:</label>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <input
                type="text"
                class="form-control"
                id="gtotal"
                name="gtotal"
                [(ngModel)]="purchase.Amount"
                readonly
              />
            </div>
          </div>
        </div>

        <div class="row no-gutter">
          <div class="col-md-6">
            <label for="Carriage" style="padding-top: 5px">Carriage:</label>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <input
                type="text"
                class="form-control"
                id="Carriage"
                name="Carriage"
                [(ngModel)]="purchase.Carriage"
                (change)="changel()"
              />
            </div>
          </div>
        </div>
        <div class="row no-gutter">
          <div class="col-md-6">
            <label for="Labour" style="padding-top: 5px">Labour:</label>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <input
                type="text"
                class="form-control"
                id="Labour"
                name="Labour"
                [(ngModel)]="purchase.Labour"
                (change)="changel()"
              />
            </div>
          </div>
        </div>

        <div class="row no-gutter">
          <div class="col-md-6">
            <label for="rdisc" style="padding-top: 5px">Discount:</label>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <input
                type="text"
                class="form-control"
                id="rdisc"
                name="rdisc"
                [(ngModel)]="purchase.Discount"
              />
            </div>
          </div>
        </div>

        <div class="row no-gutter">
          <div class="col-md-6">
            <label for="amount" style="padding-top: 5px">Net Amount:</label>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <input
                type="text"
                class="form-control"
                id="amount"
                name="amount"
                [value]="
                  purchase.NetAmount +
                  purchase.Labour * 1 +
                  purchase.Carriage * 1 -
                  purchase.Discount
                "
                readonly
              />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
