<div class="row bolditems no-gutter">
  <div class="col-md-4">
    <h5 class="mb-1">Retails Sale {{ EditID }}</h5>
  </div>
  <div class="col-md-4">
    <div *ngIf="isPosted" class="text-center btn btn-danger btn-sm">
      POSTED INVOICE
    </div>
  </div>
  <div class="col-md-4">
    <form #frmFilter="ngForm">
      <div class="row no-gutter">
        <div class="col-md-6">
          <input
            class="form-control"
            name="ino"
            [(ngModel)]="Ino"
            placeholder="Invoice No"
          />
        </div>

        <div class="col-md-4">
          <div class="form-group">
            <button
              type="submit"
              class="btn btn-primary form-control"
              (click)="FindINo()"
              accesskey="F"
            >
              <i class="fa fa-search"></i>
              Find Invoice
            </button>
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="card-block widget-body">
    <form (ngSubmit)="SaveData()" #fromPurchase="ngForm">
      <div class="row no-gutter">
        <div class="col-md-2">
          <label for="dp1">Date:</label>
          <div class="input-group">
            <input
              class="form-control"
              placeholder="yyyy-mm-dd"
              name="dp1"
              [(ngModel)]="sale.Date"
              ngbDatepicker
              #d1="ngbDatepicker"
              required
              disabled
            />
            <div class="input-group-addon">
              <button
                type="button"
                class="btn btn-warning"
                (click)="d1.toggle()"
              >
                <i class="fa fa-calendar"></i>
              </button>
            </div>
          </div>
        </div>

        <div class="form-group col-md-2">
          <label for="customer">ŸêInvoice Type</label>
          <select
            id="InvtType"
            class="form-control"
            name="InvType"
            [(ngModel)]="sale.DtCr"
          >
            <option value="CR">Sale</option>
            <option value="DT">Sale Raturn</option>
          </select>
        </div>

        <div class="form-group col-md-4">
          <label for="customer"
            >Customer
            <span class="text-right"
              ><strong> {{ SelectCust.Address }}</strong></span
            >
            <span>
              / <strong>{{ sale.PrevBalance }}</strong>
            </span></label
          >
          <ng-select
            #cmbCustomers
            name="ng2select"
            class="custom"
            [items]="Accounts"
            [virtualScroll]="true"
            bindLabel="CustomerName"
            bindValue="CustomerID"
            placeholder="Select Customer"
            (change)="CustomerSelected($event)"
            required
            [disabled]="!btnLocked"
            [(ngModel)]="sale.CustomerID"
            [searchFn]="customSearchFn"
          >
            <ng-template ng-option-tmp let-item="item">
              <div class="row no-gutter">
                <div class="col-md-12">
                  {{ item.CustomerName }}
                </div>
                <div class="col-md-9 text-italic font-small-2 mt-1">
                  <small>
                    {{ item.Address }}
                  </small>
                </div>
                <div class="col-md-3 text-italic font-small-2 mt-1">
                  <small>
                    {{ item.Balance }}
                  </small>
                </div>
              </div>
            </ng-template>
          </ng-select>
        </div>
        <div class="col-md-2">
          <label for="">
            Date:
            <span class="text-warning">
              {{ LastPrice.Date }}
            </span>
          </label>
        </div>
        <div class="col-md-2">
          <label for="">
            Last Rate:
            <span class="text-warning">
              {{ LastPrice.SPrice }}
            </span>
          </label>

          <label for="">
            Stock:
            <span class="text-danger">
              {{ LastPrice.Stock }}
            </span>
          </label>
        </div>
      </div>
      <form #formqty="ngForm">
        <div class="row no-gutter">
          <div class="col-md-2">
            <label for="dp2">Code:</label>
            <div class="input-group">
              <input
                class="form-control"
                placeholder="00000000"
                name="pcode"
                [(ngModel)]="sdetails.PCode"
                (keydown.enter)="Find()"
                [disabled]="!btnLocked"
                #Barcode
              />
              <div class="input-group-append">
                <button
                  type="button"
                  class="btn btn-primary"
                  (click)="Search()"
                >
                  <i class="fa fa-search"></i>
                </button>
              </div>
            </div>
          </div>

          <div class="col-md-2">
            <div class="form-group">
              <label for="supplier">Product:</label>
              <P
                ><strong>
                  {{ sdetails.ProductName }}
                </strong></P
              >
            </div>
          </div>

          <div class="col-md-1">
            <div class="form-group">
              <label for="qty">Qty</label>
              <input
                type="number"
                class="form-control dation-field"
                required="required"
                id="pcs"
                name="pcs"
                [(ngModel)]="sdetails.Pcs"
                #qty
                (keydown.enter)="OnQtyEnter($event)"
                (focus)="qty.select()"
              />
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label for="Remarks">Remarks:</label>
              <input
                #txtRemarks
                type="text"
                class="form-control"
                id="Remarks"
                name="Remarks"
                [(ngModel)]="sdetails.Remarks"
                (keydown.enter)="SubmitOrder()"
                (focus)="txtRemarks.select()"
              />
            </div>
          </div>
          <div class="col-md-1">
            <div class="form-group">
              <label for="RPrice">Rate:</label>
              <input
                #txtRate
                type="number"
                class="form-control"
                id="SPrice"
                name="SPrice"
                [(ngModel)]="sdetails.SPrice"
                min="1"
                required
                (keydown.enter)="btnAdd.focus()"
                (focus)="onFocus($event)"
                (click)="onFocus($event)"
                (mouseup)="onFocus($event)"
                (keydown.enter)="SubmitOrder()"
              />
            </div>
          </div>

          <div class="col-md-2">
            <div class="form-group">
              <label for="bonus">Amount:</label>
              <input
                type="number"
                class="form-control"
                id="pamount"
                name="pamount"
                readonly
                [value]="sdetails.Pcs * sdetails.SPrice"
                tabindex="-1"
              />
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label>&nbsp;</label>
              <button
                #btnAdd
                type="button"
                class="btn btn-primary form-control"
                [disabled]="
                  !formqty.form.valid || isPosted || btnLocked
                "
                (click)="AddOrder()"
                accesskey="a"
              >
                Add
              </button>
            </div>
          </div>
        </div>
      </form>
      <div
        class="table-responsive custom-table-height table-bordered table-condensed"
      >
        <ng2-smart-table
          class="table table-hover"
          [settings]="settings"
          [source]="data"
          (deleteConfirm)="onDeleteConfirm($event)"
          (editConfirm)="onEdit($event)"
        >
        </ng2-smart-table>
      </div>

      <div class="row no-gutter">
        <div class="col-md-3">
          <div class="form-group">
            <label for="notes">Notes:</label>

            <input
              type="text"
              class="form-control"
              id="notes"
              name="notes"
              [(ngModel)]="sale.Notes"
              placeholder="x"
            />
          </div>
        </div>
        <div class="col-md-9">
          <div class="row no-gutter">
            <div class="col-md-2">
              <div class="form-group">
                <label for="gtotal">Total Amount</label>
                <input
                  type="text"
                  class="form-control"
                  id="gtotal"
                  name="gtotal"
                  [(ngModel)]="sale.Amount"
                  tabindex="-1"
                  readonly
                />
              </div>
            </div>

            <div class="col-md-2">
              <div class="form-group">
                <label for="gtotal">Discount</label>
                <input
                  type="number"
                  class="form-control"
                  id="ExtraDisc"
                  name="ExtraDisc"
                  [(ngModel)]="sale.ExtraDisc"
                />
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label for="netTotal">Net Amount</label>
                <input
                  type="text"
                  class="form-control"
                  id="TNetAmount"
                  name="TNetAmount"
                  [value]="sale.Amount - sale.ExtraDisc"
                  tabindex="-1"
                  readonly
                />
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label for="netTotal">Amount Recvd</label>

                <input
                  type="text"
                  class="form-control"
                  id="AmountRecvd"
                  name="AmountRecvd"
                  [(ngModel)]="sale.AmountRecvd"
                  [value]="sale.Amount - sale.ExtraDisc"
                  readonly
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row no-gutter">
        <div class="col-md-3">
          <div class="form-group">
            <ft-navigator
              (ClickAction)="NavigatorClicked($event)"
              [disabled]="btnLocked"
            >
            </ft-navigator>
          </div>
        </div>
        <div class="col-md-9">
          <ft-buttons-bar
            #btnBar
            [buttons]="buttonConfigs"
            [disabled]="btnLocked"
          ></ft-buttons-bar>
          &nbsp;
          <ft-buttons-bar
            [buttons]="btnSave"
            [disabled]="!btnLocked"
          ></ft-buttons-bar>
        </div>
        <!-- <div class="col-md-4">
          <div class="form-group">
            <label for="notes">&nbsp;</label>
            <ft-navigator (ClickAction)="NavigatorClicked($event)">
            </ft-navigator>
          </div>
        </div>
        <div class="col-md-1">
          <div class="form-group">
            <label for="dp2">&nbsp;</label>
            <button
              type="button"
              class="btn btn-block btn-primary"
              (click)="NewInvoice()"
              accesskey="s"
            >
              New
            </button>
          </div>
        </div>
        <div class="col-md-1">
          <div class="form-group">
            <label for="dp2">&nbsp;</label>
            <button
              type="button"
              class="btn btn-primary btn-block"
              [disabled]="
                !fromPurchase.form.valid ||
                data.count() == 0 ||
                isPosted
              "
              (click)="SaveData()"
              accesskey="s"
            >
              Save
            </button>
          </div>
        </div>
        <div class="col-md-1">
          <div class="form-group">
            <label for="dp2">&nbsp;</label>
            <button
              type="button"
              class="btn btn-danger btn-block"
              (click)="Cancel()"
            >
              Cancel
            </button>
          </div>
        </div>
        <div class="col-md-1">
          <div class="form-group">
            <label for="dp2">&nbsp;</label>
            <button
              type="button"
              class="btn btn-primary btn-block"
              [disabled]="!fromPurchase.form.valid || data.count() == 0"
              (click)="PrintInvoice()"
              accesskey="p"
            >
              Print
            </button>
          </div>
        </div> -->
      </div>
    </form>
  </div>
</div>
