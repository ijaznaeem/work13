# Enhanced Reporting System Documentation

## Overview
The new reporting system provides a flexible, configuration-driven approach to generating reports with support for multiple export formats (PDF, Excel, CSV) and various templates.

## Key Features

### 1. **Configuration-Driven Architecture**
- Declarative report configuration using TypeScript interfaces
- Template-based report generation
- Separation of concerns between data, presentation, and export logic

### 2. **Multiple Export Formats**
- PDF with professional styling and formatting
- Excel with proper data types and formatting
- CSV for data interchange
- Support for bulk export in multiple formats

### 3. **Template System**
- Pre-defined templates: Standard, Invoice, Ledger, Summary
- Customizable styling and layout
- Header, footer, and content configuration

### 4. **Backward Compatibility**
- Maintains compatibility with existing `ft-dynamic-table` components
- Legacy HTML-based printing still supported
- Gradual migration path

## Usage Examples

### Basic Report Generation

```typescript
// In your component
import { ReportTemplate } from '../models/report.models';
import { PrintDataService } from '../services/print.data.services';

export class YourReportComponent {
  constructor(private ps: PrintDataService) {}

  generateReport() {
    const reportConfig = this.ps.prepareReportData(
      'Sales Report',           // title
      'Monthly Summary',        // subtitle
      this.salesData,          // data array
      this.tableColumns,       // column definitions
      this.selectedCustomer,   // customer name (optional)
      ReportTemplate.LEDGER    // template
    );

    // Set in print service and navigate
    this.ps.PrintData.reportConfig = reportConfig;
    this.router.navigateByUrl('/print/print-html');
  }
}
```

### Advanced Configuration

```typescript
// Custom report configuration
const customConfig: ReportConfig = {
  title: 'Custom Financial Report',
  subTitle: 'Q4 2024 Analysis',
  pageSize: 'A4',
  orientation: 'landscape',
  
  headerConfig: {
    showLogo: true,
    logoUrl: './assets/logo.png',
    customFields: [
      { label: 'Report Date:', value: new Date().toLocaleDateString(), position: 'right' },
      { label: 'Generated By:', value: this.currentUser.name, position: 'right' }
    ]
  },
  
  tableConfig: {
    columns: [
      { label: 'Date', field: 'date', format: 'date', width: '15%' },
      { label: 'Description', field: 'description', width: '40%' },
      { label: 'Amount', field: 'amount', format: 'currency', align: 'right', sum: true }
    ],
    data: this.financialData,
    showSummary: true,
    styling: {
      headerBackgroundColor: '#007bff',
      headerTextColor: '#ffffff',
      fontSize: 9
    }
  },
  
  exportOptions: {
    filename: 'financial-report-q4-2024',
    formats: ['pdf', 'excel']
  }
};
```

### Using Report Toolbar Component

```html
<!-- In your template -->
<app-report-toolbar
  [config]="reportConfig"
  [businessData]="businessData"
  [showBulkExport]="true"
  (print)="onPrint()"
  (exportPDF)="onExportPDF()"
  (exportMultiple)="onExportMultiple($event)">
</app-report-toolbar>

<ft-dynamic-table
  [Settings]="setting"
  [Data]="data">
</ft-dynamic-table>
```

## Migration Guide

### Step 1: Update existing components
Replace direct PrintDataService usage:

```typescript
// OLD WAY
PrintReport() {
  this.ps.PrintData.HTMLData = document.getElementById('print-section');
  this.ps.PrintData.Title = 'My Report';
  this.router.navigateByUrl('/print/print-html');
}

// NEW WAY
PrintReport() {
  const reportConfig = this.ps.prepareReportData(
    'My Report',
    this.subTitle,
    this.data,
    this.setting.Columns,
    undefined,
    ReportTemplate.STANDARD
  );
  
  this.ps.PrintData.reportConfig = reportConfig;
  // Keep legacy data for backward compatibility
  this.ps.PrintData.HTMLData = document.getElementById('print-section');
  this.ps.PrintData.Title = 'My Report';
  
  this.router.navigateByUrl('/print/print-html');
}
```

### Step 2: Add report toolbar (optional)
```html
<!-- Add this above your existing table -->
<app-report-toolbar
  [config]="reportConfig"
  [businessData]="businessData">
</app-report-toolbar>
```

## Benefits

### 1. **Consistency**
- Standardized report layouts across the application
- Consistent styling and formatting
- Professional appearance

### 2. **Maintainability**
- Configuration-driven approach reduces code duplication
- Centralized styling and formatting logic
- Easy to update report templates globally

### 3. **Flexibility**
- Support for multiple export formats
- Customizable templates and styling
- Easy to extend with new features

### 4. **Performance**
- Eliminates jQuery dependency
- More efficient PDF generation
- Better memory management

### 5. **User Experience**
- Multiple export options
- Bulk export capabilities
- Professional-looking reports
- Consistent UI across all reports

## Advanced Features

### Custom Templates
```typescript
// Create custom template configurations
const invoiceTemplate: Partial<ReportConfig> = {
  headerConfig: {
    customFields: [
      { label: 'Invoice No:', value: '', position: 'right' },
      { label: 'Due Date:', value: '', position: 'right' }
    ]
  },
  tableConfig: {
    styling: {
      headerBackgroundColor: '#28a745',
      headerTextColor: '#ffffff'
    }
  }
};
```

### Dynamic Column Configuration
```typescript
// Dynamically configure columns based on data
const columns = this.data.length > 0 
  ? Object.keys(this.data[0]).map(key => ({
      label: this.formatLabel(key),
      field: key,
      sum: this.isNumericField(key)
    }))
  : [];
```

This enhanced reporting system provides a robust foundation for all your reporting needs while maintaining backward compatibility and offering significant improvements in flexibility, maintainability, and user experience.
