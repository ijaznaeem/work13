<div id="print-section">
  <section id="savepdf" style="margin-left: 20px; margin-right: 20px">
    <table style="width: 100%; height: 100%">
      <tbody style="vertical-align: top">
        <tr>
          <td colspan="4" style="height: 1cm;">

          </td>
        </tr>

        <tr>
          <td colspan="4" class="text-center" style="font-size: 24px">
            <strong
              >{{ Invoice.DtCr == 'CR' ? 'SALE INVOICE ' : 'INVOICE RETURN' }}
            </strong>
          </td>
        </tr>
        <tr>
          <td colspan="2" class="text-left" style="width: 50%">
            <table class="" style="padding: 0px; border-collapse: collapse">
              <tr>
                <td style="width: 50%; padding: 0">Customer Name:</td>
                <td style="padding: 0">
                  <strong>{{ Invoice.CustomerName }}</strong>
                </td>
              </tr>
              <tr>
                <td style="width: 50%; padding: 0">Refrence:</td>
                <td style="padding: 0">
                  <strong>{{ Invoice.CustName }}</strong>
                </td>
              </tr>
              <tr>
                <td style="padding: 0">Contact#:</td>
                <td style="padding: 0">{{ Invoice.PhoneNo1 }}</td>
              </tr>
              <tr>
                <td style="padding: 0">Address:</td>
                <td style="padding: 0">
                  {{ Invoice.Address }}
                </td>
              </tr>
            </table>
          </td>
          <td></td>
          <td colspan="2" class="text-left" style="width: 50%">
            <table>
              <tr>
                <td style="width: 40">Invoice No:</td>
                <td>
                  {{ FormatInvNo(Invoice.InvoiceID) }}
                </td>
              </tr>
              <tr>
                <td>Invoice Date:</td>
                <td>
                  {{ FormatDate(Invoice.Date) }}
                </td>
              </tr>
              <tr>
                <td>Invoice Time:</td>
                <td>
                  {{ Invoice.Time }}
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td colspan="4" class="text-right">
            <table class="table-border">
              <thead class="">
                <tr>
                  <th style="width: 5%" class="text-center">S#</th>
                  <th class="text-center">Product Name</th>
                  <th style="width: 12%">Qty</th>
                  <th style="width: 8%">Weight</th>

                  <th style="width: 8%">Rate</th>
                  <th style="width: 12%">Amount</th>
                </tr>
              </thead>
              <tbody style="height: 100%">
                <tr *ngFor="let det of Invoice.Detail; let i = index">
                  <td class="text-center">
                    <span>{{ det.Sno }}</span>
                  </td>
                  <td class="text-left">
                    <div style="float: left">
                      {{ det.ProductName }} (
                      {{ det.Remarks }}
                      )
                    </div>
                    <span
                      style="
                        float: right;
                        text-align: right;
                        font-size: 125%;
                        font-weight: 600;
                      "
                    >
                      {{ det.ProductName2 }}
                    </span>
                  </td>
                  <td>
                    {{ RoundIt(det.Qty, 4) }}
                    <span *ngIf="det.KGs > 0">
                      - {{ RoundIt(det.KGs, 4) }}</span
                    >
                  </td>
                  <td>
                    <span
                      *ngIf="
                        ['kgs', 'inches'].includes(det.UnitName.toLowerCase())
                      "
                    >
                      {{ RoundIt(det.Weight, 2) }}
                    </span>
                  </td>
                  <td>
                    <span
                      *ngIf="
                        ['kgs', 'inches'].includes(det.UnitName.toLowerCase());
                        else ElsePart
                      "
                    >
                      {{ RoundIt(det.WPrice, 2) }}
                    </span>
                    <ng-template #ElsePart>
                      {{ RoundIt(det.SPrice, 2) }}
                    </ng-template>
                  </td>
                  <td>
                    {{ RoundIt(det.Amount, 2) }}
                  </td>
                </tr>
              </tbody>
              <tr>
                <th></th>
                <th class="text-left">
                  <!-- <strong>
                        Weight: {{ RoundTo(FindTotal('Weight') / 40, 2) }} Mon
                        <span> Grand Total: </span></strong
                      > -->
                </th>
                <th>
                  {{ FindTotal('Qty') }}
                </th>
                <th>
                  {{ FindTotal('Weight', 2) }}
                </th>
                <th></th>
                <th>
                  {{ FindTotal('Amount', 2) | number: '1.2-2' }}
                </th>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td colspan="4" style="width: 100%; vertical-align: top">
            <table>
              <tr>
                <td style="width: 50%; padding-right: 5%; vertical-align: top">
                  <div>
                    Notes:
                    <span> {{ Invoice.Notes }} </span>
                  </div>

                  <div
                    class="text-center mt-5"
                    style="
                      width: 80%;
                      text-align: center;
                      border-top: 1px;
                      border-style: solid;
                    "
                  ></div>
                  <span class="text-center"> Signature</span>
                </td>
                <td style="width: 50%; padding-left: 5%">
                  <table
                    style="width: 100%; vertical-align: top"
                    class="table table-border"
                  >
                    <tr *ngIf="Invoice.Labour > 0">
                      <td>Cutting Labour:</td>
                      <td class="text-right">
                        {{ Invoice.Labour | number: '1.0-0' }}
                      </td>
                    </tr>
                    <tr *ngIf="Invoice.LoadingCharges > 0">
                      <td style="width: 50%">Loading Charges:</td>
                      <td class="text-right">
                        {{ Invoice.LoadingCharges | number: '1.0-0' }}
                      </td>
                    </tr>
                    <tr *ngIf="Invoice.DeliveryCharges > 0">
                      <td>
                        Delivery Charges:
                        {{ Invoice.TransporterName }}
                      </td>
                      <td class="text-right">
                        {{ Invoice.DeliveryCharges | number: '1.0-0' }}
                      </td>
                    </tr>

                    <tr *ngIf="Invoice.Discount > 0">
                      <td>Discount:</td>
                      <td class="text-right">
                        {{ Invoice.Discount | number: '1.0-0' }}
                      </td>
                    </tr>

                    <tr>
                      <td>Net Amount:</td>
                      <td class="text-right">
                        {{ Invoice.NetAmount | number: '1.2-2' }}
                      </td>
                    </tr>
                    <tr>
                      <td>Previous :</td>
                      <td class="text-right">
                        {{ Invoice.PrevBalance * 1 | number: '1.0-0' }}
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <span>
                          {{
                            Invoice.DtCr == 'CR' ? 'Cash Received' : 'Payment'
                          }}
                        </span>
                      </td>
                      <td class="text-right">
                        {{ Invoice.AmntRecvd | number: '1.0-0' }}
                      </td>
                    </tr>
                    <tr>
                      <td>Total Balance:</td>
                      <td class="text-right">
                        {{
                          Invoice.PrevBalance * 1 + 1 * Invoice.Balance *( Invoice.DtCr=='CR'?1: -1)
                            | number: '1.0-0'
                        }}
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </tbody>
    </table>
    <div id="footer"></div>
  </section>
</div>

<section class="buttonarea">
  <div class="row no-pad">
    <div class="col-md-4">
      <div class="form-group">
        <button
          class="btn btn-primary"
          printSectionId="print-section"
          type="button"
          (click)="Print()"
        >
          <i class="fa fa-print"></i>
        </button>

        <button
          style="margin: 5px"
          class="btn btn-primary"
          printSectionId="print-section"
          type="button"
          (click)="SaveAsPdf()"
        >
          Save as PDF
        </button>
        <button
          style="margin: 5px"
          class="btn btn-primary"
          printSectionId="print-section"
          type="button"
          (click)="ScreenShot()"
        >
          Screen Shot
        </button>
      </div>
    </div>
  </div>
</section>
