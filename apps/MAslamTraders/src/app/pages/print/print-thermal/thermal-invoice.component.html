<section id="print-content">
  <table style="width: 100%; height: 100%">
    <tbody style="vertical-align: top">
      <tr>
        <td>
          <app-print-title [Business]="Business"></app-print-title>
        </td>
      </tr>

      <tr>
        <td class="text-center" style="font-size: 16px">
          {{ Invoice.DtCr == 'CR' ? 'SALE INVOICE ' : 'INVOICE RETURN' }}
        </td>
      </tr>
      <tr>
        <td class="text-left" style="width: 100%">
          <table class="">
            <tr>
              <td style="width: 40%">Invoice No:</td>
              <td>
                {{ FormatInvNo(Invoice.InvoiceID) }}
              </td>
            </tr>
            <tr>
              <td>Invoice Date:</td>
              <td>{{ FormatDate(Invoice.Date) }}( {{ Invoice.Time }})</td>
            </tr>
            <tr>
              <td>Customer Name:</td>
              <td>
                {{ Invoice.CustomerName }}
              </td>
            </tr>
            <tr>
              <td>Refrence:</td>
              <td>
                {{ Invoice.CustName }}
              </td>
            </tr>
            <tr>
              <td>Contact#:</td>
              <td>{{ Invoice.PhoneNo1 }}</td>
            </tr>
            <tr>
              <td>Address:</td>
              <td>
                {{ Invoice.Address }}
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr class="total line">
        <td class="text-right">
          <table class="bill-details">
            <thead>
              <tr class="total">
                <th style="width: 8%" class="text-center">S#</th>
                <th class="text-center">Product Name</th>
                <th class="text-center" style="width: 25%">Qty</th>
                <th style="width: 12%">Rt</th>
                <th style="width: 20%">Amnt</th>
              </tr>
            </thead>
            <tbody style="height: 100%">
              <tr
                class="total"
                *ngFor="let det of Invoice.Detail; let i = index"
              >
                <td class="text-center">
                  <span>{{ det.Sno }}</span>
                </td>
                <td class="text-left">
                  <div style="float: left">
                    {{ det.ProductName }} (
                    {{ det.Remarks }}
                    )
                  </div>
                  <span
                    style="float: right; text-align: right; font-size: 125% ;"
                  >
                    {{ det.ProductName2 }}
                  </span>
                </td>
                <td class="text-center">
                  <span
                    *ngIf="
                      !['kgs', 'inches'].includes(det.UnitName.toLowerCase())
                    "
                  >
                    {{ RoundIt(det.Qty, 4) }}
                    <span> - {{ RoundIt(det.KGs, 4) }}</span>
                  </span>
                  <span
                    *ngIf="
                      ['kgs', 'inches'].includes(det.UnitName.toLowerCase())
                    "
                  >
                    {{ RoundIt(det.Weight, 2) }} {{ det.UnitName.toLowerCase() }}</span
                  >
                </td>

                <td>
                  <span
                    *ngIf="
                      ['kgs', 'inches'].includes(det.UnitName.toLowerCase());
                      else rateprunit
                    "
                  >
                    {{ RoundIt(det.WPrice, 2) }}
                  </span>
                  <ng-template #rateprunit>
                    <spane>{{ RoundIt(det.SPrice, 2) }}</spane>
                  </ng-template>
                </td>
                <td>
                  {{ RoundIt(det.Amount, 2) }}
                </td>
              </tr>
            </tbody>
            <tr class="total">
              <th></th>
              <th class="text-left">
                <!--
                        Weight: {{ RoundTo(FindTotal('Weight') / 40, 2) }} Mon
                        <span> Grand Total: </span>
                      -->
              </th>
              <th class="text-center">
                {{ FindTotal('Weight', 2) }} kgs
              </th>
              <th></th>

              <th style="font-size: 0.85rem">
                {{ FindTotal('Amount', 2) | number: '1.2-2' }}
              </th>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="width: 100%; vertical-align: top">
          <table style="width: 100%; vertical-align: top">
            <tr class="total" *ngIf="Invoice.Labour > 0">
              <td>Cutting Labour:</td>
              <td style="font-size: 0.75rem" class="text-right">
                {{ Invoice.Labour | number: '1.0-0' }}
              </td>
            </tr>
            <tr class="total" *ngIf="Invoice.LoadingCharges > 0">
              <td style="width: 50%">Loading Charges:</td>
              <td style="font-size: 0.75rem" class="text-right">
                {{ Invoice.LoadingCharges | number: '1.0-0' }}
              </td>
            </tr>
            <tr class="total" *ngIf="Invoice.DeliveryCharges > 0">
              <td>Delivery Charges: ({{ Invoice.TransporterName }})</td>
              <td style="font-size: 0.75rem" class="text-right">
                {{ Invoice.DeliveryCharges | number: '1.0-0' }}
              </td>
            </tr>

            <tr class="total" *ngIf="Invoice.Discount > 0">
              <td>Discount:</td>
              <td style="font-size: 0.75rem" class="text-right">
                {{ Invoice.Discount | number: '1.0-0' }}
              </td>
            </tr>

            <tr class="total">
              <td>Net Amount:</td>
              <td style="font-size: 0.75rem" class="text-right">
                {{
                  (Invoice.NetAmount < 0
                    ? Invoice.NetAmount * -1
                    : Invoice.NetAmount
                  ) | number: '1.0-0'
                }}
              </td>
            </tr>
            <tr class="total">
              <td>Previouse :</td>
              <td style="font-size: 0.85rem" class="text-right">
                {{ Invoice.PrevBalance * 1 | number: '1.0-0' }}
              </td>
            </tr>
            <tr class="total">
              <td>Cash Received:</td>
              <td style="font-size: 0.85rem" class="text-right">
                {{ Invoice.AmntRecvd | number: '1.0-0' }}
              </td>
            </tr>
            <tr class="total">
              <td>Total Balance:</td>
              <td style="font-size: 0.85rem" class="text-right">
                {{
                  Invoice.PrevBalance * 1 + 1 * Invoice.Balance
                    | number: '1.0-0'
                }}
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="width: 100%; vertical-align: top">
          <table>
            <tr>
              <td style="width: 100%; padding-right: 5%; vertical-align: top">
                <div>
                  Notes:
                  <span>{{ Invoice.Notes }}</span>
                </div>


                <div
                  class="text-center mt-5"
                  style="
                    width: 80%;
                    text-align: center;
                    border-top: 1px;
                    border-style: solid;
                  "
                ></div>
                <span class="text-center"> Signature</span>
              </td>
              <td style="width: 50%; padding-left: 5%"></td>
            </tr>
          </table>
        </td>
      </tr>
    </tbody>
  </table>
</section>
