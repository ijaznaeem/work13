<div class="row no-pad">
  <div class="col-md-12">
    <div class="table-responsive">
      <table class="table table-sm table-dyna table-hover" style="height: 100%">
        <thead class="thead-light">
          <tr>
            <th class="screenOnly" *ngIf="settings.ButtonsAtRight"></th>
            <th *ngIf="settings.Checkbox" class="screenOnly">
              <input
                type="checkbox"
                [checked]="isAllCheckBoxChecked()"
                (change)="checkAllCheckBox($event)"
              />
            </th>
            <th *ngIf="hasSubTable" class="screenOnly"></th>
            <th *ngFor="let c of settings.Columns">{{ c.label }}</th>

            <th class="screenOnly" *ngIf="!settings.ButtonsAtRight"></th>
          </tr>
        </thead>
        <tbody>
          <ng-container
            *ngFor="
              let row of Data | filter: Search:settings.Columns;
              let i = index
            "
          >
            <tr
              (click)="ExandRow($event, i)" [ngClass]="getRowClass(row)"
              [style.background-color]="Data[i].checked ? 'yellow' : 'white'"
            >
              <ng-container *ngIf="settings.ButtonsAtRight">
                <td class="screenOnly">
                  <div
                    class="text-right"
                    ngbDropdown
                    container="body"
                    *ngIf="settings.Actions.length > 0"
                  >
                    <div *ngIf="settings.crud; else elseBlock">
                      <button
                        type="button"
                        class="btn btn-sm btn-{{ act.class || 'primary' }}"
                        [title]="act.title"
                        *ngFor="let act of settings.Actions"
                        (click)="ClickActionEv(row, act.action)"
                      >
                        <i class="fa fa-{{ act.icon }}"></i>
                      </button>
                    </div>
                    <ng-template #elseBlock>
                      <button
                        type="button"
                        class="btn btn-sm caret-off"
                        ngbDropdownToggle
                      >
                        <i
                          class="ft-more-vertical text-primary cursor-pointer mr-2"
                        >
                        </i>
                      </button>
                      <div ngbDropdownMenu>
                        <a
                          href="#"
                          ngbDropdownItem
                          *ngFor="let act of settings.Actions"
                          (click)="ClickActionEv(row, act.action)"
                        >
                          <i
                            class="fa fa-{{ act.icon }} text-{{
                              act.class || 'primary'
                            }}"
                            *ngIf="act.icon"
                          >
                          </i>
                          {{ act.title }}
                        </a>
                      </div>
                    </ng-template>
                  </div>
                </td>
              </ng-container>
              <td *ngIf="settings.Checkbox" class="screenOnly">
                <input
                  type="checkbox"
                  value="{{ Data[i].checked }}"
                  [(ngModel)]="Data[i].checked"
                />
              </td>
              <td *ngIf="hasSubTable" class="screenOnly">
                <i class="fa fa-plus" id="icon{{ i }}"></i>
              </td>
              <td *ngFor="let col of settings.Columns">
                <span
                  [ngClass]="{
                    'btn btn-sm btn-primary': col.button.style !== 'link',
                    link: col.button.style == 'link'
                  }"
                  (click)="col.button.callback(row)"
                  *ngIf="col.button; else plain"
                >
                  <img
                    class="img-responsive img-thumbnail"
                    [src]="UploadUrl + row[col.fldName]"
                    alt=""
                    *ngIf="col.type == 'image'"
                    style="max-width: 50px"
                  />
                  <span *ngIf="col.type == undefined || col.type != 'image'">
                    {{
                      col.valueFormatter
                        ? col.valueFormatter(row)
                        : row[col.fldName]
                    }}
                  </span>
                </span>

                <ng-template #plain>{{
                  col.valueFormatter ? col.valueFormatter(row) : row[col.fldName]
                }}</ng-template>
              </td>
              <ng-container *ngIf="!settings.ButtonsAtRight">
                <td class="screenOnly">
                  <div
                    class="text-right"
                    ngbDropdown
                    container="body"
                    *ngIf="settings.Actions.length > 0"
                  >
                    <div *ngIf="settings.crud; else elseBlock">
                      <button
                        type="button"
                        class="btn btn-sm btn-{{ act.class || 'primary' }}"
                        [title]="act.title"
                        *ngFor="let act of settings.Actions"
                        (click)="ClickActionEv(row, act.action)"
                      >
                        <i class="fa fa-{{ act.icon }}"></i>
                      </button>
                    </div>
                    <ng-template #elseBlock>
                      <button
                        type="button"
                        class="btn btn-sm caret-off"
                        ngbDropdownToggle
                      >
                        <i
                          class="ft-more-vertical text-primary cursor-pointer mr-2"
                        >
                        </i>
                      </button>
                      <div ngbDropdownMenu>
                        <a
                          href="#"
                          ngbDropdownItem
                          *ngFor="let act of settings.Actions"
                          (click)="ClickActionEv(row, act.action)"
                        >
                          <i
                            class="fa fa-{{ act.icon }} text-{{
                              act.class || 'primary'
                            }}"
                            *ngIf="act.icon"
                          >
                          </i>
                          {{ act.title }}
                        </a>
                      </div>
                    </ng-template>
                  </div>
                </td>
              </ng-container>
            </tr>
            <tr
              *ngIf="hasSubTable"
              [hidden]="!row.expanded"
              class="screenOnly"
              style="visibility: hidden"
              id="rsub{{ i }}"
            >
              <td [attr.colspan]="GetFldCounts() + 1" style="height: auto">
                <table class="table">
                  <thead>
                    <tr>
                      <th *ngFor="let col of SubTable.Columns">
                        {{ col.label }}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let rsub of row[SubTable.table]">
                      <td *ngFor="let col of SubTable.Columns">
                        {{ rsub[col.fldName] }}
                      </td>
                    </tr>
                  </tbody>
                </table>
              </td>
            </tr>
          </ng-container>
        </tbody>
        <tfoot class="thead-light">
          <tr>
            <th *ngIf="settings.Checkbox" class="screenOnly"></th>
            <th *ngIf="hasSubTable" class="screenOnly"></th>
            <th *ngFor="let c of settings.Columns">
              <!-- {{ c.sum ? c.sumValue > 0 ? c.SumValue : FindTotal(c.fldName) : "" }} -->
              {{ c.sum ? FindTotal(c.fldName) : '' }}
            </th>
            <th></th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>
