<div id="print-section">
  <div>
    <div>
      <section id="savepdf">
        <table style="width: 100%; height: 100%">
          <tbody style="vertical-align: top">
            <tr>
              <td colspan="4" *ngIf="Invoice.Type != 3">
                <app-print-title [Business]="Business"></app-print-title>
              </td>
            </tr>

            <tr>
              <td colspan="2" class="text-right" style="width: 30%">
                <table>
                  <tr>
                    <td>{{ Invoice.InvoiceID }}</td>
                    <td>بل نمبر:</td>
                  </tr>
                  <tr>
                    <td>{{ Invoice.Date }}</td>
                    <td>تاریخ:</td>
                  </tr>
                </table>
              </td>

              <td colspan="2" style="width: 70%">
                <table class="text-right">
                  <tr>
                    <td>
                      <span style="font-size: 16pt; font-weight: 700">
                        <strong>{{ Invoice.CustomerName }}</strong></span
                      >
                    </td>
                    <td style="width: 30%">خریدار کا نام:</td>
                  </tr>
                  <tr>
                    <td>{{ Invoice.Address }}, {{ Invoice.City }}</td>
                    <td>پتہ:</td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td colspan="4" class="text-right">
                <table class="table-border">
                  <thead class="">
                    <tr>
                      <th style="width: 15%">رقم</th>
                      <th style="width: 10%">ریٹ</th>
                      <th style="width: 10%"></th>
                      <th class="text-center" style="width: 10%">تعداد</th>
                      <th class="text-center">تفصیل</th>
                      <th style="width: 10%" class="text-center">نمبر شمار</th>
                    </tr>
                  </thead>
                  <tbody style="height: 100%">
                    <tr *ngFor="let det of Invoice.Detail; let i = index">
                      <td>
                        {{ RoundIt(det.Amount, 2) }}
                      </td>
                      <td>{{ RoundIt(det.SPrice, 2) }}</td>
                      <td>
                        {{ det.UnitName }}
                      </td>
                      <td class="text-center">
                        {{ RoundIt(det.Qty, 2) }}
                      </td>
                      <td class="text-r">
                        <span style="font-weight: 600">
                          {{ det.ProductName }}
                        </span>
                      </td>
                      <td class="text-center">
                        <span>{{ det.Sno }}</span>
                      </td>
                    </tr>
                  </tbody>
                  <tr>
                    <th>
                      <strong>{{
                        FindTotal('Amount') | number: '1.0-0'
                      }}</strong>
                    </th>
                    <th></th>
                    <th></th>
                    <th class="text-center">
                      <strong>{{ FindTotal('Qty') }}</strong>
                    </th>

                    <th class="text-left"></th>
                    <th></th>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td colspan="4" style="width: 100%; vertical-align: top">
                <table>
                  <tr>
                    <td
                      style="width: 50%; padding-right: 5%; vertical-align: top"
                    >
                      <table
                        style="width: 100%; vertical-align: top"
                        class="table table-border text-right"
                      >
                        <tr>
                          <td class="text-right">
                            <strong>{{
                              Invoice.NetAmount | number: '1.0-0'
                            }}</strong>
                          </td>
                          <td style="width: 50%">موجودہ بل:</td>
                        </tr>
                        <tr>
                          <td class="text-right">
                            <strong>{{
                              (Invoice.IsPosted == 1
                                ? Invoice.PrevBalance - Invoice.Balance
                                : Invoice.PrevBalance
                              ) | number: '1.0-0'
                            }}</strong>
                          </td>
                          <td style="width: 50%">سابقہ بقایہ:</td>
                        </tr>
                        <tr>
                          <td class="text-right">
                            <strong>{{
                              (Invoice.IsPosted == 1
                                ? Invoice.PrevBalance - Invoice.NetAmount
                                : Invoice.PrevBalance
                              ) | number: '1.0-0'
                            }}</strong>
                          </td>
                          <td style="width: 50%">کل رقم:</td>
                        </tr>
                        <tr>
                          <td class="text-right">
                            <strong>{{
                              Invoice.AmntRecvd | number: '1.0-0'
                            }}</strong>
                          </td>
                          <td style="width: 50%">وصولی:</td>
                        </tr>

                        <tr>
                          <td class="text-right">
                            <strong>{{
                              (Invoice.IsPosted == 1
                                ? Invoice.PrevBalance
                                : Invoice.PrevBalance * 1 + Invoice.Balance * 1
                              ) | number: '1.0-0'
                            }}</strong>
                          </td>
                          <td>ٹوٹل بقایا:</td>
                        </tr>
                      </table>

                      <div>
                        نوٹ:
                        <span
                          ><strong>{{ Invoice.Notes }}</strong></span
                        >
                      </div>
                      <div>
                        <strong> اڈہ : </strong>
                        <span>
                          <strong>{{ Invoice.CustName }}</strong>
                        </span>
                      </div>

                      <div
                        class="text-center mt-3"
                        style="
                          width: 80%;
                          text-align: center;
                          border-top: 1px;
                          border-style: solid;
                        "
                      ></div>
                      <span class="text-center"> دستخط</span>
                    </td>
                    <td style="width: 50%; vertical-align: top">
                      <table
                        class="table table-border text-right"
                        style="width: 100%; vertical-align: top"
                      >
                        <tr>
                          <td class="">
                            <strong>{{
                              Invoice.Amount | number: '1.0-0'
                            }}</strong>
                          </td>
                          <td style="width: 50%">کل رقم:</td>
                        </tr>
                        <tr>
                          <td class="text-right">
                            {{ Invoice.Discount | number: '1.0-0' }}
                          </td>
                          <td>رعائت:</td>
                        </tr>
                        <tr>
                          <td class="text-right">
                            {{ Invoice.Labour | number: '1.0-0' }}
                          </td>
                          <td>مزدوری:</td>
                        </tr>
                        <tr>
                          <td class="text-right">
                            <strong>{{
                              (Invoice.NetAmount < 0
                                ? Invoice.NetAmount * -1
                                : Invoice.NetAmount
                              ) | number: '1.0-0'
                            }}</strong>
                          </td>
                          <td><strong>صافی رقم:</strong></td>
                        </tr>
                      </table>
                      <div
                        id="notes"
                        class="text-right"
                        style="font-weight: bold"
                      ></div>
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td colspan="4" class="text-center">
                <tr>
                  <td *ngFor="let bank of extra" style="width: 25%">
                    <table class="table table-border" style="width: 100%">
                      <tr>
                        <td>
                          <strong>{{ bank.AccountTitle }}</strong>
                        </td>
                      </tr>
                      <tr>
                        <td>{{ bank.BankName }}</td>
                      </tr>
                      <tr>
                        <td>{{ bank.AccountNo }}</td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </td>
            </tr>
          </tbody>
        </table>

        <div id="footer"></div>
      </section>
    </div>
  </div>
</div>

<section class="buttonarea">
  <div class="row no-pad">
    <div class="col-md-4">
      <div class="form-group">
        <button
          class="btn btn-primary"
          printSectionId="print-section"
          type="button"
          (click)="Print()"
        >
          <i class="fa fa-print"></i>
        </button>

        <button
          style="margin: 5px"
          class="btn btn-primary"
          printSectionId="print-section"
          type="button"
          (click)="SaveAsPdf()"
        >
          Save as PDF
        </button>
      </div>
    </div>
  </div>
</section>
